"use strict";(self["webpackChunkvue_toutiao"]=self["webpackChunkvue_toutiao"]||[]).push([[245],{245:function(t,s,e){e.r(s),e.d(s,{default:function(){return h}});var i=function(){var t=this,s=t._self._c;return s("div",[s("div",{staticClass:"search-header"},[s("van-icon",{staticClass:"goback",attrs:{name:"arrow-left",color:"white",size:"18"},on:{click:function(s){return t.$router.back()}}}),s("van-search",{ref:"searchRef",attrs:{placeholder:"请输入搜索关键词",background:"#007BFF",shape:"round"},on:{input:t.onInput},model:{value:t.kw,callback:function(s){t.kw="string"===typeof s?s.trim():s},expression:"kw"}})],1),0!=t.kw.length?s("div",{staticClass:"sugg-list"},t._l(t.suggestList,(function(e,i){return s("div",{key:i,staticClass:"sugg-item",domProps:{innerHTML:t._s(e)},on:{click:t.gotoSearchResult}})})),0):s("div",{staticClass:"search-history"},[s("van-cell",{attrs:{title:"搜索历史"},scopedSlots:t._u([{key:"right-icon",fn:function(){return[s("van-icon",{staticClass:"search-icon",attrs:{name:"delete"},on:{click:function(s){t.history=[]}}})]},proxy:!0}])}),s("div",{staticClass:"history-list"},t._l(t.history,(function(e,i){return s("span",{key:i,staticClass:"history-item",on:{click:t.gotoSearchResult}},[t._v(t._s(e))])})),0)],1)])},n=[],r=e(672),o={name:"Search",data(){return{kw:"",timerId:null,suggestList:[],history:JSON.parse(localStorage.getItem("history")||"[]")}},mounted(){const t=document.querySelector("input[type=search]");t&&t.focus()},methods:{onInput(){clearTimeout(this.timerId),0!==this.kw.length?this.timerId=setTimeout((()=>{this.initSuggestList()}),500):this.suggestList=[]},async initSuggestList(){const{data:t}=await(0,r.Y)(this.kw);if("OK"===t.message){this.hlightKeywords(t.data.options),this.suggestList=t.data.options;const s=this.history.filter((t=>t!==this.kw));s.unshift(this.kw),this.history=s}},hlightKeywords(t){const s=new RegExp(this.kw,"ig");t.forEach(((e,i)=>{t[i]=e.replace(s,(t=>`<span style="color: red; font-weight: bold;">${t}</span>`))}))},gotoSearchResult(t){const s=t.currentTarget.innerText;this.$router.push("/search/"+s)}},watch:{history(t){localStorage.setItem("history",JSON.stringify(t))}}},a=o,c=e(1),u=(0,c.Z)(a,i,n,!1,null,"3a812f20",null),h=u.exports},672:function(t,s,e){e.d(s,{S:function(){return r},Y:function(){return n}});var i=e(361);const n=t=>i.Z.get("/v1_0/suggestion",{params:{q:t}}),r=(t,s)=>i.Z.get("/v1_0/search",{params:{q:t,page:s}})}}]);
//# sourceMappingURL=245.bfc01bce.js.map